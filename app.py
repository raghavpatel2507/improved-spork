import streamlit as st
from PIL import Image
import tensorflow as tf
import numpy as np

# Load the pre-trained model
model = tf.keras.models.load_model('potatoes.h5')


def classify_disease(image):
    image = tf.image.resize(image, (256, 256))  # Resize to (256, 256)
    image = np.array(image)
    image = image / 255.0  # Normalize the image
    image = image.reshape((1, 256, 256, 3))  # Update the shape
    result = model.predict(image)
    return result



# Set the title and description
st.title('ЁЯеФЁЯФНтЬи AGGRINATION ЁЯУ╕ЁЯМ▒ЁЯжа')
st.write('This web app classifies potato diseases into three categories: Early Blight, Late Blight, and Healthy.')

# Upload the image
uploaded_image = st.file_uploader("Upload a potato image...", type=["jpg", "png", "jpeg"])

if uploaded_image is not None:
    image = Image.open(uploaded_image)
    st.image(image, caption='Uploaded Image', use_column_width=True)

    if st.button("Classify"):
        result = classify_disease(image)



        CLASS_NAMES = ['Early Blight', 'Late Blight', 'Healthy']
        predicted_class = CLASS_NAMES[np.argmax(result[0])]

        st.success(f'Predicted Class: {predicted_class}')
        st.write('Prediction Probabilities:')
        if predicted_class == 'Early Blight':
            st.write("It appears that your potato plants are predicted to have Early Blight.")
            st.write('ркмркЯрк╛ркХрк╛ркирк╛ рк░рлЛркЧркирк╛ рккрлНрк░рк╛рк░ркВркнрк┐ркХ ркЦрлБркорк╛рк░рлАркирлЗ ркЖрккркгрлЗ ркХрлЗрк╡рлА рк░рлАркдрлЗ ркирк┐ркпркВркдрлНрк░рк┐ркд ркХрк░рлА рк╢ркХрлАркП?')
            st.write('ркпрлЛркЧрлНркп ркЧрк░рлНркнрк╛ркзрк╛рки, рк╕рк┐ркВркЪрк╛ркИ ркЕркирлЗ ркЕркирлНркп ркЬркВркдрлБркУркирк╛ рк╡рлНркпрк╡рк╕рлНркерк╛рккрки рк╕рк╣рк┐ркд рк╢рлНрк░рлЗрк╖рлНрка рк╡рлГркжрлНркзрк┐ркирлА рк╕рлНркерк┐ркдрк┐ ркЬрк╛рк│рк╡рлА рк░рк╛ркЦрлАркирлЗ рккрлНрк░рк╛рк░ркВркнрк┐ркХ ркЦрлБркорк╛рк░рлАркирлЗ ркШркЯрк╛ркбрлА рк╢ркХрк╛ркп ркЫрлЗ. рккркЫрлАркерлА рккрк╛ркХркдрлА, рк▓рк╛ркВркмрлА ркорлЛрк╕ркоркирлА ркЬрк╛ркдрлЛ ркЙркЧрк╛ркбрлЛ. рклрлВркЧркирк╛рк╢ркХркирлЛ ркЙрккркпрлЛркЧ ркдрлНркпрк╛рк░рлЗ ркЬ рк╡рк╛ркЬркмрлА ркЫрлЗ ркЬрлНркпрк╛рк░рлЗ рк░рлЛркЧ ркЖрк░рлНркерк┐ркХ ркирлБркХрк╕рк╛рки рккрк╣рлЛркВркЪрк╛ркбрк╡рк╛ ркорк╛ркЯрлЗ рккрлВрк░ркдрлЛ рк╡рк╣рлЗрк▓рлЛ рк╢рк░рлВ ркХрк░рк╡рк╛ркорк╛ркВ ркЖрк╡рлЗ.')
            st.write("рклрлВркЧркирк╛рк╢ркХ рк╕рлНрккрлНрк░рлЗ рккрлНрк░рк╛рк░ркВркнрк┐ркХ ркЦрлБркорк╛рк░рлА ркЕркирлЗ ркЕркирлНркп рккрк╛ркВркжркбрк╛ркирк╛ рклрлЛрк▓рлНрк▓рлАркУркирлЗ ркирк┐ркпркВркдрлНрк░рк┐ркд ркХрк░рк╡рк╛ ркорк╛ркЯрлЗ ркЕрк╕рк░ркХрк╛рк░ркХ ркЫрлЗ. ркХрлНрк▓рлЛрк░рлЛркерлЗрк▓рлЛркирк┐рк▓ (0.20%), ркорлЗркирлНркХрлЛркЭрлЗркм (0.20%) ркЕркерк╡рк╛ рккрлНрк░рлЛрккрлАркирлЗркм (0.20%) рк╕рк╛ркерлЗ рккрк╛ркХ рккрк░ ркЫркВркЯркХрк╛рк╡ ркХрк░рк╡рк╛ркерлА ркЖ рк░рлЛркЧрлЛркирлА ркХрк╛рк│ркЬрлА рк▓ркИ рк╢ркХрк╛ркп ркЫрлЗ. ркЦрк╛ркдрк░рлЛркирлА ркнрк▓рк╛ркоркг ркХрк░рлЗрк▓ ркорк╛ркдрлНрк░рк╛ ркЦрк╛рк╕ ркХрк░рлАркирлЗ ркирк╛ркИркЯрлНрк░рлЛркЬркиркирлЛ ркЙрккркпрлЛркЧ ркХрк░рлЛ.")
        elif predicted_class == 'Late Blight':
            st.write("It appears that your potato plants are predicted to have Late Blight.")
            st.write('What is the solution for late blight of potato?')
            st.write("ркХрлЗрк▓рлНрк╢рк┐ркпрко рккрлЛрк╖ркХ ркдркдрлНркдрлНрк╡рлЛ рк╕рк╛ркерлЗ ркЫрк╛ркВркЯрк╡рк╛ркорк╛ркВ ркЖрк╡ркдрк╛ ркмркЯрк╛ркХрк╛ркирк╛ ркЫрлЛркбркорк╛ркВ ркорлЛркбрк╛ ркмрлНрк▓рк╛ркИркЯ рк░рлЛркЧркирлА ркУркЫрлА ркдрлАрк╡рлНрк░ркдрк╛ ркЕркирлЗ ркХркВркжркирлА рк╡ркзрлЗрк▓рлА ркЙрккркЬ ркЫрлЛркбркирлА рккрлЗрк╢рлАркУркорк╛ркВ ркХрлЗрк▓рлНрк╢рк┐ркпркоркирк╛ рк╡ркзрлБ рк╕ркВркЪркпркирлЗ ркХрк╛рк░ркгрлЗ рк╣рлЛркИ рк╢ркХрлЗ ркЫрлЗ.")
            st.write('рк▓рлЗркЯ ркмрлНрк▓рк╛ркИркЯ/ркмркЯрк╛ркЯрк╛/ркЦрлЗркдрлА: ркЬркВркдрлБ рк╡рлНркпрк╡рк╕рлНркерк╛рккрки...ркХрк▓ рккрк╛ркИрк▓рлНрк╕ ркЕркирлЗ рк╕рлНрк╡ркпркВрк╕рлЗрк╡ркХ ркмркЯрк╛ркХрк╛ркирлЗ ркирк╛ркмрлВркж ркХрк░рлАркирлЗ, ркпрлЛркЧрлНркп рк▓ркгркгрлА ркЕркирлЗ рк╕ркВркЧрлНрк░рк╣ рккркжрлНркзркдрк┐ркУркирлЛ ркЙрккркпрлЛркЧ ркХрк░рлАркирлЗ ркЕркирлЗ ркЬрлНркпрк╛рк░рлЗ ркЬрк░рлВрк░рлА рк╣рлЛркп ркдрлНркпрк╛рк░рлЗ рклрлВркЧркирк╛рк╢ркХркирлЛ ркЙрккркпрлЛркЧ ркХрк░рлАркирлЗ рк▓рлЗркЯ ркмрлНрк▓рк╛ркИркЯркирлЗ ркирк┐ркпркВркдрлНрк░рк┐ркд ркХрк░рк╡рк╛ркорк╛ркВ ркЖрк╡рлЗ ркЫрлЗ. ркжрк░рк░рлЛркЬ рккрк░рлНркгрк╕ркорлВрк╣ркирлЗ рк╕рлВркХрк╡рк╡рк╛ ркорк╛ркЯрлЗ рк╣рк╡рк╛ркирлБркВ ркбрлНрк░рлЗркирлЗркЬ ркорк╣ркдрлНрк╡рккрлВрк░рлНркг ркЫрлЗ.')
        else:
            st.write(
                "Your potato plants appear to be healthy. Regularly fertilize them with a balanced fertilizer to maintain their health and vigor.")

# Footer
st.write('ЁЯМЯ Thank you for using our website! ЁЯШКЁЯСН')
